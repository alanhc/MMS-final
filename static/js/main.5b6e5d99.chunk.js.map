{"version":3,"sources":["utils/storage.js","utils/axios.js","utils/config.js","utils/context.js","utils/AuthReducer.js","hooks/useWallet.js","components/HeaderBar.js","components/Collection.js","containers/Home.js","containers/Ticket.js","containers/Scan.js","App.js","reportWebVitals.js","index.js"],"names":["LS_AUTH_TOKEN","CK_WALLET_ADDR","storage","Object","defineProperty","get","localStorage","getItem","set","value","setItem","cookie","load","save","path","clearAccountData","removeItem","remove","instance","axios","create","baseURL","process","interceptors","request","use","config","token","authToken","headers","SimpleFormData","data","key","append","FormData","getPayLoad","address","then","res","payload","login","_address","_signature","param","signature","post","access_token","renewToken","getCollectionByAddress","result","activateTicket","contract","tokenId","responseType","getQRcode","imgData","file","verifyQRcode","_file","AuthContext","createContext","authState","isLoggedIn","walletAddres","authDispatcher","authStatusReducer","state","type","console","log","walletAddress","AuthDispatcherAction","AUTO_SYNC","LOGIN","LOGOUT","Tezos","TezosToolkit","wallet","BeaconWallet","name","setWalletProvider","useWallet","useContext","useState","setWalletAdrress","connectWallet","client","requestPermissions","permissions","requestSignPayload","signingType","SigningType","MICHELINE","response","HeaderBar","Box","sx","flexGrow","AppBar","position","color","enableColorOnDark","Toolbar","Typography","variant","component","Button","onClick","Collection","collections","setCollections","useEffect","fetchCollections","collectionList","Item","styled","Paper","theme","backgroundColor","palette","mode","typography","body2","padding","spacing","textAlign","text","secondary","mt","Grid","container","justifyContent","keys","map","to","Home","useReducer","jwt","decode","Error","catch","e","window","location","reload","scrollTo","top","behavior","checkLocalStorage","onJwtChanged","newValue","addEventListener","removeEventListener","Provider","Ticket","id","useParams","ticket","setTicket","blob","setBlob","onClickActivate","URL","createObjectURL","document","getElementById","src","activateBtn","useBtn","style","display","onClickUse","width","align_items","justify","item","xs","thumbnailUri","marginLeft","marginRight","Scan","setData","setResult","status","onResult","error","height","align","App","basename","element","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","createRoot","render","StrictMode"],"mappings":"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","file":"static/js/main.5b6e5d99.chunk.js","sourcesContent":["import cookie from \"react-cookies\";\n/**\n * keys\n */\nexport const LS_AUTH_TOKEN = \"atk\";\nexport const CK_WALLET_ADDR = \"addr\";\n\nconst storage = {};\n\nObject.defineProperty(storage, \"authToken\", {\n  get: () => localStorage.getItem(LS_AUTH_TOKEN),\n  set: (value) => {\n    localStorage.setItem(LS_AUTH_TOKEN, value);\n  },\n});\n\nObject.defineProperty(storage, \"walletAddress\", {\n  get: () => cookie.load(CK_WALLET_ADDR),\n  set: (value) => {\n    cookie.save(CK_WALLET_ADDR, value, { path: \"/\" });\n  },\n});\n\nstorage.clearAccountData = () => {\n  localStorage.removeItem(LS_AUTH_TOKEN);\n  cookie.remove(CK_WALLET_ADDR);\n};\n\nexport default storage;\n","import axios from \"axios\"\nimport { SERVER_URL } from \"./config\"\nimport storage from \"./storage\"\n\nconst instance = axios.create({ baseURL: SERVER_URL});\n\ninstance.interceptors.request.use((config) => {\n    const token = storage.authToken;\n    config.headers[\"Authorization\"] = token ? `Bearer ${token}` : \"\";\n  \n    return config;\n});\n\nclass SimpleFormData extends FormData {\n    constructor(data) {\n      super();\n      for (let key in data) {\n        this.append(key, data[key]);\n      }\n    }\n};\n\nexport const getPayLoad = async (address) => {\n    return await instance.get(`/login/${address}/payload`).then((res) => {\n        return res.data.payload;\n    });\n}\n\nexport const login = async (_address, _signature) => {\n    const param = new SimpleFormData({\n        address: _address,\n        signature: _signature,\n    });\n\n    return await instance.post('/login', param).then((res) => {\n        return res.data.access_token;\n    });\n}\n\nexport const renewToken = async () => {\n    return await instance.get('/renew_token').then((res) => {\n        return res.data.access_token;\n    });\n}\n\nexport const getCollectionByAddress = async (address) => {\n    return await instance.get(`/collections/${address}`).then((res) => {\n        return res.data.result;\n    });\n}\n\nexport const activateTicket = async(contract, tokenId) => {\n    return await instance.get(`/activate_ticket/${contract}/${tokenId}`, {responseType: 'blob'}).then((res) => {\n        return res.data; \n    });\n}\n\nexport const getQRcode = async(contract, tokenId, imgData) => {\n    const param = new SimpleFormData({\n        file: imgData\n    });\n\n    return await instance.post(`/qrcode/${contract}/${tokenId}`, param, {responseType: 'blob'}).then((res) => {\n        return res.data;\n    });\n}\n\nexport const verifyQRcode = async(contract, tokenId, _file) => {\n    const param = new SimpleFormData({\n        file: _file\n    });\n\n    return await instance.post(`/verify/${contract}/${tokenId}`, param).then((res) => {\n        return res;\n    });\n}","import \"dotenv/config\"\nconst { REACT_APP_SERVER_URL: SERVER_URL } = process.env;\n\nexport { SERVER_URL };","import { createContext, Context } from \"react\";\n\nexport const AuthContext = createContext({\n    authState: {\n        isLoggedIn: false,\n        walletAddres: \"\"\n    },\n    authDispatcher: () => {},\n});","import storage from \"./storage\"\n\nconst authStatusReducer = (state, {type, payload}) => {\n    console.log(\"Dispatcher state: \", type);\n    let walletAddress = payload?.walletAddress ?? \"\";\n    let token = payload?.token;\n\n    switch (type) {\n        case AuthDispatcherAction.AUTO_SYNC:\n            if (token) {\n                storage.authToken = token;\n                return state;\n            }\n            else {\n                return state;\n            }\n        \n        case AuthDispatcherAction.LOGIN:\n            storage.authToken = token;\n            storage.walletAddress = walletAddress;\n            return {\n                isLoggedIn: true,\n                walletAddress\n            };\n\n        case AuthDispatcherAction.LOGOUT:\n            storage.clearAccountData();\n            return {\n                isLoggedIn: false,\n                walletAddress: \"\"\n            }\n        \n        default:\n            return state;\n    }\n};\n\nconst AuthDispatcherAction = {\n    AUTO_SYNC: 0,\n    LOGIN: 1,\n    LOGOUT: 2\n}\n\nexport { authStatusReducer, AuthDispatcherAction }","import { TezosToolkit } from \"@taquito/taquito\"\nimport { BeaconWallet } from \"@taquito/beacon-wallet\"\nimport { SigningType } from \"@airgap/beacon-sdk\"\nimport { useState, useContext } from \"react\"\nimport { getPayLoad, login } from \"../utils/axios\"\nimport { AuthContext } from \"../utils/context\"\nimport { AuthDispatcherAction } from \"../utils/AuthReducer\"\n\nconst Tezos = new TezosToolkit(\"https://mainnet-tezos.giganode.io\");\nconst wallet = new BeaconWallet({ \n    name: \"Mutimedia-Security-Term-Project\"\n});\n\nTezos.setWalletProvider(wallet);\n\nconst useWallet = () => {\n    const { authState, authDispatcher } = useContext(AuthContext);\n    const [walletAddress, setWalletAdrress] = useState(\"\");\n\n    const connectWallet = async () => {\n        try {\n            // 1. Request permission\n            const permissions = await wallet.client.requestPermissions();\n            console.log(\"Got permissions: \", permissions.address);\n\n            let address = permissions.address;\n            setWalletAdrress(address);\n\n            // 2. Get payload to sign in\n            const payload = await getPayLoad(permissions.address);\n            console.log(\"Got payload: \", payload);\n\n            // 3. Sign payload\n            const response = await wallet.client.requestSignPayload({\n                signingType: SigningType.MICHELINE,\n                payload: payload\n            });\n            console.log(\"Got signature: \", response.signature)\n\n            let signature = response.signature;\n\n            // 4. Log in\n            await login(address, signature).then((authToken) => {\n                console.log(\"Login Successful!\");\n                console.log(authToken);\n                authDispatcher({\n                    type: AuthDispatcherAction.LOGIN,\n                    payload: {\n                        walletAddress: address,\n                        token: authToken\n                    }\n                });\n            });\n\n        } catch (error) {\n            setWalletAdrress(\"\");\n            console.log(\"Got error: \", error);\n        }\n    }\n\n    return { walletAddress, connectWallet };\n};\n\nexport default useWallet;","import { AppBar, Box, Toolbar, Typography, Button } from '@mui/material'\nimport { useContext } from 'react';\nimport useWallet from '../hooks/useWallet'\nimport { AuthContext } from '../utils/context';\n\nconst HeaderBar = () => {\n  const { connectWallet } = useWallet();\n  const onClickConnect = () => {\n    connectWallet();\n  }\n  const { authState, authDispatcher } = useContext(AuthContext);\n\n\treturn (\n    <Box sx={{ flexGrow: 1 }}>\n      <AppBar position=\"static\" color=\"default\" enableColorOnDark>\n        <Toolbar>\n          {/* <IconButton\n            size=\"large\"\n            edge=\"start\"\n            color=\"inherit\"\n            aria-label=\"menu\"\n            sx={{ mr: 2 }}\n          >\n          </IconButton> */}\n          <Typography variant=\"h6\" component=\"div\" sx={{ flexGrow: 1 }}>\n            *\n          </Typography>\n          { authState?.isLoggedIn ? (\n            <>\n              <Button variant=\"outlined\" color=\"inherit\">Synced</Button>\n            </>\n    \n          ) : (\n            <Button variant=\"outlined\" color=\"inherit\" onClick={ onClickConnect }>Sync</Button>\n          )}\n        </Toolbar>\n      </AppBar>\n    </Box>\n  )\n};\n\nexport default HeaderBar;","import { Box, Paper, Grid } from \"@mui/material\"\nimport { styled } from '@mui/material/styles';\nimport { useContext, useEffect, useState } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { AuthContext } from '../utils/context';\nimport { getCollectionByAddress } from \"../utils/axios\"\nimport storage from \"../utils/storage\";\n\nconst Collection = () => {\n    const { authState, authDispatcher } = useContext(AuthContext);\n    const [collections, setCollections] = useState({});\n\n    useEffect(() => {\n        const fetchCollections = async () => {\n            let contentList = [];\n\n            if (storage.walletAddress) {\n                const collectionList = await getCollectionByAddress(storage.walletAddress)\n                setCollections(collectionList);\n            }\n        }\n\n        fetchCollections();\n    })\n\n    const Item = styled(Paper)(({ theme }) => ({\n        backgroundColor: theme.palette.mode === 'dark' ? '#1A2027' : '#fff',\n        ...theme.typography.body2,\n        padding: theme.spacing(1),\n        textAlign: 'center',\n        color: theme.palette.text.secondary,\n      }));\n\n    return(\n        <Box sx={{ flexGrow: 1 }} mt={5}>\n            { authState?.isLoggedIn ? (\n            <Grid container spacing={2} justifyContent=\"center\">\n                { Object.keys(collections).map(key => (\n                    <Item key={key}><Link to={`/ticket/${collections[key].tokenId}`}>NFT TICKET #{collections[key].tokenId}</Link></Item>\n                ))}\n            </Grid>\n            ) : (\n                <>\n                </>\n            )}\n        </Box>\n    )\n}\n\nexport default Collection;","import { useEffect, useReducer, useState } from 'react';\nimport jwt from \"jsonwebtoken\";\nimport HeaderBar from '../components/HeaderBar.js'\nimport Collection from '../components/Collection';\nimport { renewToken } from '../utils/axios';\nimport storage, { LS_AUTH_TOKEN } from '../utils/storage';\nimport { authStatusReducer, AuthDispatcherAction } from '../utils/AuthReducer';\nimport { AuthContext } from '../utils/context';\n\nconst Home = () => {\n  // const location = useLocation();\n\n  const initAuthState = () => {\n    const authToken = storage.authToken;\n    if (authToken && storage.walletAddress) {\n      const { address } = jwt.decode(authToken) ?? {};\n      if (address === storage.walletAddress) {\n        return {\n          isLoggedIn: true,\n          walletAddress: address,\n        }\n      }\n    }\n\n    storage.clearAccountData();\n    return {\n      isLoggedIn: false,\n      walletAddress: \"\",\n    }\n  }\n\n  const [authState, authDispatcher] = useReducer(authStatusReducer, {}, initAuthState)\n\n  const checkJwt = () => {\n    renewToken()\n      .then((token) => {\n        if (jwt.decode(token)?.address !== storage.walletAddress) {\n          throw new Error(\"Inconsistent address\");\n        }\n        authDispatcher({\n          type: AuthDispatcherAction.AUTO_SYNC,\n          payload: {\n            token\n          }\n        });\n      })\n      .catch((e) => {\n        authDispatcher({ type: AuthDispatcherAction.LOGOUT });\n        window.location.reload();\n      });\n  }\n\n  useEffect(() => {\n    if (storage.authToken && storage.walletAddress) {\n      checkJwt();\n    } else {\n      authDispatcher({\n        type: AuthDispatcherAction.LOGOUT,\n      })\n    }\n\n    window.scrollTo({\n      top: 0,\n      behavior: \"smooth\",\n    });\n  }, []);\n\n  useEffect(() => {\n    function checkLocalStorage(e) {\n      switch (e.key) {\n        case LS_AUTH_TOKEN:\n          onJwtChanged(e.newValue);\n          break;\n        default:\n          break;\n      }\n    }\n\n    const onJwtChanged = (authToken) => {\n      if (authToken && storage.walletAddress) {\n        const { address } = jwt.decode(authToken);\n\n        if (address === storage.walletAddress) {\n          authDispatcher({\n            type: AuthDispatcherAction.AUTO_SYNC,\n            payload: {\n              walletAddress: address,\n              token: authToken,\n            }\n          });\n          return;\n        }\n      }\n\n      authDispatcher({\n        type: AuthDispatcherAction.LOGOUT,\n      });\n    };\n\n    window.addEventListener(\"storage\", checkLocalStorage);\n\n    return () => {\n      window.removeEventListener(\"storage\", checkLocalStorage);\n    };\n  }, []);\n\n  return (\n    <AuthContext.Provider value={{ authState, authDispatcher }}>\n      <HeaderBar />\n      <Collection />\n    </AuthContext.Provider>\n  )\n}\n\nexport default Home;\n","import { Box, Button, Paper, Grid } from \"@mui/material\"\nimport { styled } from '@mui/material/styles';\nimport { useParams } from 'react-router-dom';\nimport { useContext, useEffect, useState } from \"react\";\nimport { AuthContext } from '../utils/context';\nimport { getCollectionByAddress } from \"../utils/axios\"\nimport HeaderBar from \"../components/HeaderBar\";\nimport storage from \"../utils/storage\";\nimport { activateTicket, getQRcode } from \"../utils/axios\";\n\nconst Ticket = () => {\n    const { id } = useParams();\n    const { authState, authDispatcher } = useContext(AuthContext);\n    const [collections, setCollections] = useState({});\n    const [ticket, setTicket] = useState({});\n    const [blob, setBlob] = useState({});\n\n    \n    const onClickActivate = async () => {\n        console.log(\"Fetching image\");\n        const res = await activateTicket(ticket.contract, ticket.tokenId);\n\n        localStorage.setItem(\"imgData\", URL.createObjectURL(res));\n        console.log(localStorage.getItem(\"imgData\"))\n        await setBlob(res);\n\n        let resImg = document.getElementById(\"img\");\n        resImg.src = URL.createObjectURL(res);    \n\n        let activateBtn = document.getElementById(\"activateBtn\");\n        let useBtn = document.getElementById(\"useBtn\");\n\n        activateBtn.style.display = \"none\";\n        useBtn.style.display = \"block\";\n    }    \n\n    const onClickUse = async () => {\n        console.log(\"Fetching QR\");\n        const res = await getQRcode(ticket.contract, ticket.tokenId, blob);\n        console.log(\"Got QR\");\n\n        let resImg = document.getElementById(\"qrcode\");\n        resImg.src = URL.createObjectURL(res);    \n    }\n\n    useEffect(() => {\n        const fetchCollections = async () => {\n\n            if (storage.walletAddress) {\n                const collectionList = await getCollectionByAddress(storage.walletAddress)\n                setCollections(collectionList);\n\n                for (let key in collections) {\n                    if (collections[key].tokenId == id) {\n                        setTicket(collections[key]);\n                    }\n                }\n            }\n        }\n\n        fetchCollections();\n    })\n    \n    return (\n        <Box>\n            <HeaderBar />\n            <Box sx={{ width: \"100%\" }} mt={5} display=\"flex\" align_items=\"center\" justify=\"center\">\n                <Grid container spacing={2} justifyContent=\"center\">\n                    <Grid item xs={8}>\n                        <img id=\"img\" src={ticket.thumbnailUri} style={{ display: \"block\", marginLeft: \"auto\", marginRight: \"auto\" }} />\n                    </Grid>\n                    <Grid item xs={8} justifyContent=\"center\">\n                        <Button id=\"activateBtn\" variant=\"outlined\" color=\"inherit\" onClick={ onClickActivate }\n                            style={{ display: \"block\", marginLeft: \"auto\", marginRight: \"auto\" }}>\n                                Activate Ticket\n                        </Button>\n                        <Button id=\"useBtn\" variant=\"outlined\" color=\"inherit\" onClick={ onClickUse }\n                            style={{ display: \"none\", marginLeft: \"auto\", marginRight: \"auto\" }}>\n                                Use Ticket\n                        </Button>\n                    </Grid>\n                    <Grid item xs={8}>\n                        <img id=\"qrcode\" style={{ display: \"block\", marginLeft: \"auto\", marginRight: \"auto\" }} />\n                    </Grid>\n                </Grid>\n            </Box>\n        </Box>\n    )\n}\n\nexport default Ticket;","import { Box, Button, Paper, Grid } from \"@mui/material\"\nimport { styled } from '@mui/material/styles';\nimport { useParams } from 'react-router-dom';\nimport { useContext, useEffect, useState } from \"react\";\nimport { AuthContext } from '../utils/context';\nimport { verifyQRcode, getCollectionByAddress } from \"../utils/axios\"\nimport HeaderBar from \"../components/HeaderBar\";\nimport storage from \"../utils/storage\";\nimport { QrReader } from 'react-qr-reader';\n\n\nconst Scan = () => {\n    const { id } = useParams();\n    const [data, setData] = useState('No result');\n    const [collections, setCollections] = useState({});\n    const [ticket, setTicket] = useState({});\n    const [result, setResult] = useState(\"\");\n\n    const onClickUse = async () => {\n        console.log(\"verifying\")\n        const res = await verifyQRcode(ticket.contract, ticket.tokenId, data);\n\n        setResult(res.data.status);\n    }\n\n    useEffect(() => {\n        const fetchCollections = async () => {\n            if (storage.walletAddress) {\n                const collectionList = await getCollectionByAddress(storage.walletAddress)\n                setCollections(collectionList);\n\n                for (let key in collections) {\n                    if (collections[key].tokenId == id) {\n                        setTicket(collections[key]);\n                    }\n                }\n            }\n        }\n\n        fetchCollections();\n    })\n\n    return (\n        <Box>\n            <HeaderBar />\n            <QrReader\n            onResult={(result, error) => {\n                if (!!result) {\n                    setData(result?.text);\n                    setResult(\"Scanned.\")\n                }\n    \n                if (!!error) {\n                    // console.info(error);\n                }\n            }}\n            style={{ height:'10px' }}\n            />\n            <Grid container spacing={2} justifyContent=\"center\">\n                <Grid item xs={8} justifyContent=\"center\">\n                    <p align=\"center\"> {result} </p>\n                </Grid>\n            </Grid>\n            <Grid container spacing={2} justifyContent=\"center\">\n                <Grid item xs={8} justifyContent=\"center\">\n                    <Button id=\"activateBtn\" variant=\"outlined\" color=\"inherit\" onClick={ onClickUse }\n                        style={{ display: \"block\", marginLeft: \"auto\", marginRight: \"auto\" }}>\n                            Verify\n                    </Button>\n                </Grid>\n            </Grid>\n            \n      </Box>\n    );\n}\n\nexport default Scan;","import { useEffect, useReducer, useState } from 'react';\nimport { BrowserRouter as Router, Routes, Route } from 'react-router-dom';\nimport Home from './containers/Home';\nimport Ticket from './containers/Ticket';\nimport Scan from './containers/Scan';\n\nconst App = () => {\n  return (\n      <Router basename='{process.env.PUBLIC_URL}'>\n      <Routes>\n        <Route path=\"/\" element={<Home/>} />\n        <Route path=\"/ticket/:id\" element={<Ticket />} />\n        <Route path=\"/scan/:id\" element={<Scan />} />\n      </Routes>\n      </Router>\n  )\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom/client';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nconst root = ReactDOM.createRoot(document.getElementById('root'));\nroot.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}